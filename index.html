<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3DSCAN Viewer</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: sans-serif; }
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 8px;
            pointer-events: none;
        }
        a { color: #4af; text-decoration: none; pointer-events: auto; }
    </style>
</head>
<body>
    <div id="info">
        <h3>üßä 3DSCAN Viewer</h3>
        <p>Model: <span id="model-name">Loading...</span></p>
        <p><small>Powered by <a href="https://github.com/antimatter15/splat" target="_blank">antimatter15/splat</a></small></p>
    </div>

    <script type="module">
        import * as SPLAT from 'https://cdn.jsdelivr.net/npm/gsplat@latest/dist/package/index.js'; // Using gsplat for better compatibility or antimatter directly

        // We will use a simple iframe pointing to the robust antimatter15 viewer for simplicity and stability
        // This avoids CORS issues if we use the query param method on their hosted viewer,
        // OR we can embed the library. Let's try the direct embedding method for a custom feel.
        
        // Actually, the simplest stable way for a quick user page is to use the heavy lifting library.
        // Let's use mkkellogg's simple implementation or just redirect/iframe if complicated.
        // Wait, best approach for user:
        // Use importing script from antimatter15's main.js is tricky due to module paths.
        
        // Let's use the widely compatible "GaussianSplats3D" by mkkellogg via modules.
    </script>
    
    <!-- Switching to mkkellogg/GaussianSplats3D for easier standalone HTML usage -->
    <script type="module">
        import * as GaussianSplats3D from 'https://unpkg.com/@mkkellogg/gaussian-splats-3d/build/gaussian-splats-3d.module.js';

        // ‚ö†Ô∏è REPLACE THIS LINK WITH YOUR GITHUB RELEASE LINK
        // ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Ñ‡πå:
        // 1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà GitHub Repo -> Releases -> ‡∏™‡∏£‡πâ‡∏≤‡∏á Release ‡πÉ‡∏´‡∏°‡πà
        // 2. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå .ply ‡∏´‡∏£‡∏∑‡∏≠ .splat
        // 3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß -> Copy link address
        // 4. ‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡πÅ‡∏õ‡∏∞‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
        const defaultModel = 'https://github.com/PRIDA-TAKON/3DSCAN/releases/download/splat/splat.ply'; 

        // Check if url param exists
        const params = new URLSearchParams(window.location.search);
        const url = params.get('url') || defaultModel;

        document.getElementById('model-name').textContent = url.split('/').pop();

        const viewer = new GaussianSplats3D.Viewer({
            'cameraUp': [0, -1, -0.6],
            'initialCameraPosition': [-1, -4, 6],
            'initialCameraLookAt': [0, 0, 0]
        });
        
        viewer.addSplatScene(url, {
            'splatAlphaRemovalThreshold': 5,
            'showLoadingUI': true,
            'position': [0, 1, 0],
            'rotation': [0, 0, 0, 1],
            'scale': [1.5, 1.5, 1.5]
        })
        .then(() => {
            viewer.start();
        })
        .catch(err => {
            console.error("Failed to load:", err);
            document.getElementById('info').innerHTML += `<br><span style="color:red">‚ùå Load Failed: ${err}</span><br><small>Did you upload the file to GitHub Releases?</small>`;
        });
    </script>
</body>
</html>
